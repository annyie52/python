# Numpy

- 수치 계산을 하기 위한 파이썬 모듈
- 백터, 행렬, 텐서 단위의 대용량 수치 연산을 빠르게 진행할 수 있다.
- numpy의 배열 타입을 `ndarray`라고 한다.

```
import numpy as np
```



## 배열의 종류

보통 숫자 데이터만 들어가 있을 때를 배열이라고 한다.



1. 스칼라 - 0 Rank Tensor

- 0차원 데이터
- 측정한 하나의 값



2. 벡터 - 1 Rank Tensor

- 1차원 배열
- 스칼라가 연속적으로 모여 있는 것
- 백터 내의 데이터가 N개 있으면 N차원 벡터라고 한다.



3. 행렬 - 2 Rank Tensor

- 2차원 배열
- 1차원 배열인 벡터가 여러 개 모여 있는 것



4. 텐서 - 3 Rank Tensor

- 3차원 이상의 배열 (N차원 배열)



## numpy 기본 함수

- `np.arange`: 파이썬의 range 함수와 매우 비슷
- `np.zeros` : 0으로 채워진 0 벡터를 만들 때 사용
- `np.ones`: 1로 채워진 1 벡터를 만들 때 사용
- `np.full`: 지정한 숫자로 채워진 N차원 배열 생성 가능

```
np.full((2, 3), 7)
```

- `np.eye`: 단위 행렬(대각선 방향의 원소가 1이고, 나머지는 0인 행렬) 만들기
- `np.linspace(시작 숫자, 끝 숫자, n)`: 시작 숫자부터 끝 숫자까지 n개의 숫자를 균등한 구간으로 나눈다.



## 랜덤을 사용하기 위한 numpy

- 랜덤 배열은 딥러닝에서 매개변수(가중치, 편향)을 초기화하기 위해서 사용



- `np.random.rand`: 완전 랜덤 만들기(정규분포나 균등 분포가 아닌)
- `np.random.randn`: 정규분포 랜덤값 만들기
- `np.random.uniform`: 균등 분포 랜덤값 만들기

```
np.random.uniform(1.0, 3.0, size=(4,5))
```

- `np.random.choice`: 정수 랜덤 샘플링
  - 중복 추출을 원하지 않으면 replace=True 옵션을 넣어 준다.

```
np.random.choce(10, size=(2, 3), replace=True)
```

- `np.random.randint`: 랜덤 정수 배열 만들기



## axis(축) 이해하기

- 데이터가 추가되는 방향의 인덱스



예를 들어 3차원 배열 (3, 4, 5)

- 3차원 배열에 추가되는 건 2차원 배열 -> `axis:0`
- 2차원 배열에 추가되는 건 1차원 배열 -> `axis:1`
- 1차원 배열에 추가되는 건 0차원 스칼라 -> `axis:2`



 ## 배열의 차원과 형상

- 형상: `.shape`, `.reshape`
  - `.reshape`에서 -1을 사용하면 -1 위치의 값이 자동으로 계산되어서 들어간다.
- 차원 수: `.ndim`



## 차원 수 확장, 축소

- 차원 수 확장 방법: `np.newaxis`
- 차원 수 축소 방법: `np.squeeze`



## 배열의 형상 바꾸기

평탄화: 2차원 이상의 배열을 1차원 배열로 평평하게 펴주는 것



- `ravel`: 원본 배열을 평탄화시킨 참조 배열을 만들어 낸다. 원본 데이터에 영향을 미친다.
- `flatten`: 원본 배열을 평탄화시킨 복사된 배열을 만들어 낸다. 원본 데이터에 영향을 미치지 않는다.